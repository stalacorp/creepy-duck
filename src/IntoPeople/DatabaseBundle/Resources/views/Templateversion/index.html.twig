{% extends '::base.html.twig' %}

{% block body -%}
    <h2>{{ 'templates.index.title' | trans }}</h2>

    {{ form(form) }}

    <a href="{{ path('templateversion_new') }}" type="button" class="btn btn-default">{{ 'button.create' | trans }}</a>


    <div id="result"></div>



{% endblock %}

{% block javascripts -%}
    {{ parent() }}


    <script>

        function gettemplates() {
            $.ajax({
                url: Routing.generate('hr_getcycles', {
                    generalcycleid: $('#form_generalcycle').val(),
                    cycle: $('#form_cycle').val(),
                    _locale:locale
                }),
                success: function (result) {
                    $("#result").html(result);

                    $('.history').click(function(){
                        $.ajax({
                            url: Routing.generate('hr_history', {cycle: $('#form_cycle').val(), id: $(this).data('id'), _locale:locale }),
                            success: function (result) {
                                $('#historymodal').html(result);
                                $('#myHistoryModal').modal('show');
                            }
                        });
                    });


                }
            });
        }

        $(function () {
            Chart.defaults.global.responsive = true;
            gettemplates();

            $('#form_templateversion').change(function () {
                gettemplates();
            });
        });

    </script>
{% endblock %}